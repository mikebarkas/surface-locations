{% extends 'base.html' %}

{% block title %}
  <title>About the project</title>
{% endblock title %}

{% block content %}
<div class="container">
  <h1>About</h1>
  <p>{{ context }}</p>
</div>

<div class="container">
<div id="graph-example"></div>
</div>


{% endblock content %}

{% block javascript %}
  {{ block.super }}
  <script src="https://d3js.org/d3.v3.min.js"></script>
  <script>

    d3.json("{% url 'api-json' state='NC' %}", function(error, data) {

      var margin = {top: 20, right: 20, bottom: 30, left: 40},
          width = 960 - margin.left - margin.right,
          height = 500 - margin.top - margin.bottom;
          padding = 2;

      var svg = d3.select('#graph-example').append('svg')
          .attr({
            width:width + margin.left + margin.right,
            height:height + margin.top + margin.bottom
          })
          .append("g")
          .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

      var dataset = data.results;

      var y = d3.scale.linear().range([height, 0]);

      var yAxis = d3.svg.axis()
          .scale(y)
          .orient('left');

      svg.selectAll('rect')
        .data(dataset)
        .enter()
        .append('rect')
        .attr('x', function(d,i) {return i * (width / dataset.length);})
        .attr('y', function(d) {return height - (d.population * .03) - 15;})
        .attr('width', function(d) {return width / dataset.length - padding;})
        .attr('height', function(d) {return (d.population * .03);})
        .attr('fill', function(d) {return '#336699';});

      svg.selectAll('text')
        .data(dataset)
        .enter()
        .append('text')
        .text(function(d) {return d.zipcode;})
        .attr({
          'text-anchor': 'middle',
          'font-size': '10',
          x: function(d,i) {return i * (width / dataset.length) + (width / dataset.length - padding) / 2;},
          y: function(d) {return 470;},
        });
    });
  </script>

{% endblock javascript %}
